(WooInvoicePayment=WooInvoicePayment||{}).Checkout=function(){var i=this,n=jQuery;return i.doing_ajax=!1,i.selectors={paymentMethodRadio:'input[name="payment_method"]',shippingMethodSelect:'select[name="woocommerce_invoice_payment_shipping_choice"]'},i.bindEvents=function(){n(document).ready(function(){"1"===woocommerce_invoice_payment.hide_billing_fields&&(i.toggleBillingTerms(),setTimeout(function(){i.updateSessionPaymentMethod()},50))}),n(document.body).on("payment_method_selected",function(){i.toggleBillingTerms(),setTimeout(function(){i.updateSessionPaymentMethod()},50)}),n(document.body).on("updated_checkout",function(){i.toggleLocalPickup(),i.toggleTaxSubtotal(),i.toggleBodyClass()}),n(document).on("change",i.selectors.shippingMethodSelect,function(){setTimeout(function(){i.updateSessionPaymentMethod()},50)}),n(document).on("change",i.selectors.paymentMethodRadio,function(){i.toggleBillingTerms(),setTimeout(function(){i.updateSessionPaymentMethod(),n(document.body).trigger("update_checkout")},50)}),n(document.body).on("checkout_error",function(){i.validateShippingMethod()}),n(document).on("change",i.selectors.shippingMethodSelect,function(){i.validateShippingMethod(),i.toggleLocalPickup()})},i.toggleTaxSubtotal=function(){var e=n(i.selectors.paymentMethodRadio+":checked").val();void 0!==e&&""!==e&&("invoice"==e&&woocommerce_invoice_payment.hide_tax_subtotal?(n(".tax-total").hide(),n(".tax-rate").hide()):(n(".tax-total").show(),n(".tax-rate").show()))},i.toggleBillingTerms=function(){var e;"1"!==woocommerce_invoice_payment.hide_billing_fields?i.toggleBillingFields(!1):void 0!==(e=n(i.selectors.paymentMethodRadio+":checked").val())&&""!==e&&("invoice"!==e?i.toggleBillingFields(!1):i.toggleBillingFields(!0))},i.toggleBodyClass=function(){"invoice"==n(i.selectors.paymentMethodRadio+":checked").val()?n("body").addClass("has-invoice-payment-method"):n("body").removeClass("has-invoice-payment-method")},i.updateSessionPaymentMethod=function(){i.doing_ajax=!0;var e,o=n(i.selectors.paymentMethodRadio+":checked").val();void 0!==o&&""!==o&&(e=n(i.selectors.shippingMethodSelect).val(),n.ajax({url:woocommerce_invoice_payment.ajaxurl,type:"post",datatype:"json",data:{action:"update_session_payment_method",nonce:woocommerce_invoice_payment.nonce,payment_method:o,shipping_method:e},success:function(e){i.doing_ajax=!1,"1"===woocommerce_invoice_payment.hide_billing_fields&&(n(i.selectors.paymentMethodRadio+":checked").val(),"invoice"!==e.data.new_payment_method&&e.data.billing_fields,i.populateBillingFields(e.data.billing_fields),i.toggleBillingFields(e.data.hide_billing),setTimeout(function(){n(document.body).trigger("country_to_state_changed"),n(document.body).trigger("update_checkout")},500))},error:function(e){console.log(e)}}))},i.populateBillingFields=function(e){n(".woocommerce-billing-fields__field-wrapper").html(e)},i.toggleBillingFields=function(e){var o=n(".woocommerce-billing-fields").find(".form-row, .address-book-selection").not("#billing_first_name_field").not("#billing_last_name_field").not("#billing_email_field"),t=n("#ship-to-different-address");e?(n(".woocommerce-checkout").addClass("billing-fields-hidden"),n(o).hide(),n(t).hide()):(n(".woocommerce-checkout").removeClass("billing-fields-hidden"),n(o).show(),n(t).show()),n(document).trigger("woocommerce-invoice-payment-billing-fields-toggled",[e])},i.validateShippingMethod=function(){var e=n(i.selectors.shippingMethodSelect),o=n(e).parents("tr"),t=n(e).parents(".form-row");""==n(e).val()||0==n(e).val()?(n(o).addClass("has-error"),n(t).addClass("woocommerce-invalid-required-field")):(n(o).removeClass("has-error"),n(t).removeClass("woocommerce-invalid-required-field"))},i.invoicePaymentSelected=function(){return"invoice"===n(i.selectors.paymentMethodRadio+":checked").val()},i.localPickupSelected=function(){var e=n(i.selectors.shippingMethodSelect).val();return!(void 0===e||!e.includes("_local_pickup_expanded"))},i.toggleLocalPickup=function(){var e;i.invoicePaymentSelected()&&(e=n(".woocommerce-local-pickup-expanded-checkout"),i.localPickupSelected()?n(e).show():n(e).hide())},i.bindEvents()};var WooInvoicePayment=WooInvoicePayment||{};jQuery(document).ready(function(){new WooInvoicePayment.Factory}),WooInvoicePayment.Factory=function(){jQuery;return this.build=function(){new WooInvoicePayment.Checkout},this.build()};